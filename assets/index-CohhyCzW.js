import{M as H,L as E,a1 as Se,aC as ae,d as $,a7 as U,T as A,Y as L,j as V,aD as Ve,c as T,a9 as he,aa as pe,aE as Ee,au as be,g as c,aF as Ce,V as oe,R as ke,ac as R,ad as Pe,aG as De,H as W,W as we,O as ie,N as Ie,S as Me,aH as He,J as se,aI as q,X as Te,Z as J,ab as $e,a8 as Be,ay as Ne,az as Fe,aJ as Ue,aK as ce,aL as Q,a as X,o as Z,h as ue,w as S,e as y,t as re,m as Le,am as ee,P as Re,F as ze,aM as Ae}from"./index-DtDyeMHQ.js";import{C as Ye}from"./index-BxiIYkUX.js";import{C as Ke}from"./index-CnQL02jt.js";import{b as de}from"./route-block-B_A1xBdJ.js";const[Ge,_,me]=H("picker"),ye=e=>e.find(l=>!l.disabled)||e[0];function je(e,l){const n=e[0];if(n){if(Array.isArray(n))return"multiple";if(l.children in n)return"cascade"}return"default"}function z(e,l){l=ae(l,0,e.length);for(let n=l;n<e.length;n++)if(!e[n].disabled)return n;for(let n=l-1;n>=0;n--)if(!e[n].disabled)return n;return 0}const ve=(e,l,n)=>l!==void 0&&e.some(u=>u[n.value]===l);function le(e,l,n){const u=e.findIndex(g=>g[n.value]===l),o=z(e,u);return e[o]}function We(e,l,n){const u=[];let o={[l.children]:e},g=0;for(;o&&o[l.children];){const f=o[l.children],h=n.value[g];if(o=Se(h)?le(f,h,l):void 0,!o&&f.length){const v=ye(f)[l.value];o=le(f,v,l)}g++,u.push(f)}return u}function qe(e){const{transform:l}=window.getComputedStyle(e),n=l.slice(7,l.length-1).split(", ")[5];return Number(n)}function Je(e){return E({text:"text",value:"value",children:"children"},e)}const fe=200,ge=300,Qe=15,[Oe,te]=H("picker-column"),_e=Symbol(Oe);var Xe=$({name:Oe,props:{value:L,fields:U(Object),options:A(),readonly:Boolean,allowHtml:Boolean,optionHeight:U(Number),swipeDuration:U(L),visibleOptionNum:U(L)},emits:["change","clickOption","scrollInto"],setup(e,{emit:l,slots:n}){let u,o,g,f,h;const v=V(),p=V(),r=V(0),i=V(0),C=Ve(),k=()=>e.options.length,x=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,O=s=>{let m=z(e.options,s);const t=-m*e.optionHeight,a=()=>{m>k()-1&&(m=z(e.options,s));const d=e.options[m][e.fields.value];d!==e.value&&l("change",d)};u&&t!==r.value?h=a:a(),r.value=t},w=()=>e.readonly||!e.options.length,P=s=>{u||w()||(h=null,i.value=fe,O(s),l("clickOption",e.options[s]))},b=s=>ae(Math.round(-s/e.optionHeight),0,k()-1),B=T(()=>b(r.value)),K=(s,m)=>{const t=Math.abs(s/m);s=r.value+t/.003*(s<0?-1:1);const a=b(s);i.value=+e.swipeDuration,O(a)},D=()=>{u=!1,i.value=0,h&&(h(),h=null)},G=s=>{if(!w()){if(C.start(s),u){const m=qe(p.value);r.value=Math.min(0,m-x())}i.value=0,o=r.value,g=Date.now(),f=o,h=null}},j=s=>{if(w())return;C.move(s),C.isVertical()&&(u=!0,Ce(s,!0));const m=ae(o+C.deltaY.value,-(k()*e.optionHeight),e.optionHeight),t=b(m);t!==B.value&&l("scrollInto",e.options[t]),r.value=m;const a=Date.now();a-g>ge&&(g=a,f=m)},I=()=>{if(w())return;const s=r.value-f,m=Date.now()-g;if(m<ge&&Math.abs(s)>Qe){K(s,m);return}const a=b(r.value);i.value=fe,O(a),setTimeout(()=>{u=!1},0)},N=()=>{const s={height:"".concat(e.optionHeight,"px")};return e.options.map((m,t)=>{const a=m[e.fields.text],{disabled:d}=m,F=m[e.fields.value],M={role:"button",style:s,tabindex:d?-1:0,class:[te("item",{disabled:d,selected:F===e.value}),m.className],onClick:()=>P(t)},xe={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:a};return c("li",M,[n.option?n.option(m,t):c("div",xe,null)])})};return he(_e),pe({stopMomentum:D}),Ee(()=>{const s=u?Math.floor(-r.value/e.optionHeight):e.options.findIndex(a=>a[e.fields.value]===e.value),m=z(e.options,s),t=-m*e.optionHeight;u&&m<s&&D(),r.value=t}),be("touchmove",j,{target:v}),()=>c("div",{ref:v,class:te(),onTouchstartPassive:G,onTouchend:I,onTouchcancel:I},[c("ul",{ref:p,style:{transform:"translate3d(0, ".concat(r.value+x(),"px, 0)"),transitionDuration:"".concat(i.value,"ms"),transitionProperty:i.value?"all":"none"},class:te("wrapper"),onTransitionend:D},[N()])])}});const[Ze]=H("picker-toolbar"),Y={title:String,cancelButtonText:String,confirmButtonText:String},et=["cancel","confirm","title","toolbar"],tt=Object.keys(Y);var nt=$({name:Ze,props:Y,emits:["confirm","cancel"],setup(e,{emit:l,slots:n}){const u=()=>{if(n.title)return n.title();if(e.title)return c("div",{class:[_("title"),"van-ellipsis"]},[e.title])},o=()=>l("cancel"),g=()=>l("confirm"),f=()=>{var v;const p=(v=e.cancelButtonText)!=null?v:me("cancel");if(!(!n.cancel&&!p))return c("button",{type:"button",class:[_("cancel"),oe],onClick:o},[n.cancel?n.cancel():p])},h=()=>{var v;const p=(v=e.confirmButtonText)!=null?v:me("confirm");if(!(!n.confirm&&!p))return c("button",{type:"button",class:[_("confirm"),oe],onClick:g},[n.confirm?n.confirm():p])};return()=>c("div",{class:_("toolbar")},[n.toolbar?n.toolbar():[f(),u(),h()]])}});const[at]=H("picker-group"),lt=Symbol(at);E({tabs:A(),activeTab:R(0),nextStepText:String,showToolbar:ke},Y);const ot=E({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:R(44),showToolbar:ke,swipeDuration:R(1e3),visibleOptionNum:R(6)},Y),it=E({},ot,{columns:A(),modelValue:A(),toolbarPosition:Me("top"),columnsFieldNames:Object});var st=$({name:Ge,props:it,emits:["confirm","cancel","change","scrollInto","clickOption","update:modelValue"],setup(e,{emit:l,slots:n}){const u=V(),o=V(e.modelValue.slice(0)),{parent:g}=he(lt),{children:f,linkChildren:h}=Pe(_e);h();const v=T(()=>Je(e.columnsFieldNames)),p=T(()=>De(e.optionHeight)),r=T(()=>je(e.columns,v.value)),i=T(()=>{const{columns:t}=e;switch(r.value){case"multiple":return t;case"cascade":return We(t,v.value,o);default:return[t]}}),C=T(()=>i.value.some(t=>t.length)),k=T(()=>i.value.map((t,a)=>le(t,o.value[a],v.value))),x=T(()=>i.value.map((t,a)=>t.findIndex(d=>d[v.value.value]===o.value[a]))),O=(t,a)=>{if(o.value[t]!==a){const d=o.value.slice(0);d[t]=a,o.value=d}},w=()=>({selectedValues:o.value.slice(0),selectedOptions:k.value,selectedIndexes:x.value}),P=(t,a)=>{O(a,t),r.value==="cascade"&&o.value.forEach((d,F)=>{const M=i.value[F];ve(M,d,v.value)||O(F,M.length?M[0][v.value.value]:void 0)}),se(()=>{l("change",E({columnIndex:a},w()))})},b=(t,a)=>{const d={columnIndex:a,currentOption:t};l("clickOption",E(w(),d)),l("scrollInto",d)},B=()=>{f.forEach(a=>a.stopMomentum());const t=w();return se(()=>{const a=w();l("confirm",a)}),t},K=()=>l("cancel",w()),D=()=>i.value.map((t,a)=>c(Xe,{value:o.value[a],fields:v.value,options:t,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:p.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:d=>P(d,a),onClickOption:d=>b(d,a),onScrollInto:d=>{l("scrollInto",{currentOption:d,columnIndex:a})}},{option:n.option})),G=t=>{if(C.value){const a={height:"".concat(p.value,"px")},d={backgroundSize:"100% ".concat((t-p.value)/2,"px")};return[c("div",{class:_("mask"),style:d},null),c("div",{class:[He,_("frame")],style:a},null)]}},j=()=>{const t=p.value*+e.visibleOptionNum,a={height:"".concat(t,"px")};return!e.loading&&!C.value&&n.empty?n.empty():c("div",{ref:u,class:_("columns"),style:a},[D(),G(t)])},I=()=>{if(e.showToolbar&&!g)return c(nt,Ie(ie(e,tt),{onConfirm:B,onCancel:K}),ie(n,et))},N=t=>{t.forEach((a,d)=>{a.length&&!ve(a,o.value[d],v.value)&&O(d,ye(a)[v.value.value])})};W(i,t=>N(t),{immediate:!0});let s;return W(()=>e.modelValue,t=>{!q(t,o.value)&&!q(t,s)&&(o.value=t.slice(0),s=t.slice(0)),e.modelValue.length===0&&N(i.value)},{deep:!0}),W(o,t=>{q(t,e.modelValue)||(s=t.slice(0),l("update:modelValue",s))},{immediate:!0}),be("touchmove",Ce,{target:u}),pe({confirm:B,getSelectedOptions:()=>k.value}),()=>{var t,a;return c("div",{class:_()},[e.toolbarPosition==="top"?I():null,e.loading?c(we,{class:_("loading")},null):null,(t=n["columns-top"])==null?void 0:t.call(n),j(),(a=n["columns-bottom"])==null?void 0:a.call(n),e.toolbarPosition==="bottom"?I():null])}}});const ct=Te(st),[ut,ne]=H("switch"),rt={size:L,loading:Boolean,disabled:Boolean,modelValue:J,activeColor:String,inactiveColor:String,activeValue:{type:J,default:!0},inactiveValue:{type:J,default:!1}};var dt=$({name:ut,props:rt,emits:["change","update:modelValue"],setup(e,{emit:l,slots:n}){const u=()=>e.modelValue===e.activeValue,o=()=>{if(!e.disabled&&!e.loading){const f=u()?e.inactiveValue:e.activeValue;l("update:modelValue",f),l("change",f)}},g=()=>{if(e.loading){const f=u()?e.activeColor:e.inactiveColor;return c(we,{class:ne("loading"),color:f},null)}if(n.node)return n.node()};return $e(()=>e.modelValue),()=>{var f;const{size:h,loading:v,disabled:p,activeColor:r,inactiveColor:i}=e,C=u(),k={fontSize:Be(h),backgroundColor:C?r:i};return c("div",{role:"switch",class:ne({on:C,loading:v,disabled:p}),style:k,tabindex:p?void 0:0,"aria-checked":C,onClick:o},[c("div",{class:ne("node")},[g()]),(f=n.background)==null?void 0:f.call(n)])}}});const mt=Te(dt),vt="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1713850165468'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='6560'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20d='M21.333%20512a490.667%20490.667%200%201%200%20981.334%200%20490.667%20490.667%200%201%200-981.334%200z'%20fill='%23E1E0FC'%20p-id='6561'%20data-spm-anchor-id='a313x.search_index.0.i0.216a3a81XzpQWQ'%3e%3c/path%3e%3cpath%20d='M155.733%20849.067c8.534-27.734%2019.2-46.934%2032-57.6C204.8%20774.4%20403.2%20710.4%20428.8%20682.667c25.6-27.734%2019.2-59.734%2014.933-74.667-4.266-14.933-49.066-59.733-59.733-106.667-27.733-27.733-34.133-78.933-21.333-87.466-12.8-76.8-6.4-108.8%208.533-132.267s27.733-83.2%2087.467-98.133%2087.466%2012.8%20125.866%2010.666C620.8%20192%20620.8%20183.467%20640%20192c19.2%208.533%202.133%2053.333%2019.2%2093.867%2017.067%2040.533%2010.667%2061.866%206.4%20123.733%2021.333%2034.133-6.4%2078.933-21.333%2091.733C633.6%20554.667%20590.933%20595.2%20586.667%20608c-2.134%2012.8-10.667%2072.533%2057.6%20104.533%2068.266%2032%20170.666%2061.867%20198.4%2078.934%2017.066%2012.8%2027.733%2032%2027.733%2057.6C772.267%20953.6%20652.8%201004.8%20512%201002.667c-140.8-2.134-260.267-53.334-356.267-153.6z'%20fill='%23F0EEFF'%20p-id='6562'%3e%3c/path%3e%3c/svg%3e",ft={class:"layout-bg p-[16px] flex-1"},gt={key:0},ht={key:1},pt=$({__name:"index",setup(e){const l=Ne(),n=T(()=>l.userInfo),u=T(()=>!!n.value.user_id),o=T({get:()=>Fe.value,set:()=>Ue()}),g=V(!1),f=T(()=>ce.find(r=>r.value===Q.value).text),h=V([Q.value]);function v(r){Q.value=r.selectedOptions[0].value,g.value=!1}function p(){u.value||Ae.push({name:"login",query:{redirect:"/profile"}})}return(r,i)=>{const C=Le,k=Ke,x=Ye,O=mt,w=ct,P=Re;return Z(),X(ze,null,[ue("div",ft,[c(x,{inset:!0},{default:S(()=>[c(k,{center:"","is-link":!y(u),onClick:p},{title:S(()=>[c(C,{src:y(n).avatar||y(vt),round:"",class:"h-56 w-56"},null,8,["src"])]),value:S(()=>[y(u)?(Z(),X("span",gt,re(y(n).nickname),1)):(Z(),X("span",ht,re(r.$t("profile.login")),1))]),_:1},8,["is-link"])]),_:1}),c(x,{title:r.$t("menus.basicSettings"),border:!1,inset:!0},{default:S(()=>[c(k,{center:"",title:r.$t("menus.darkMode")},{"right-icon":S(()=>[c(O,{modelValue:y(o),"onUpdate:modelValue":i[0]||(i[0]=b=>ee(o)?o.value=b:null),size:"20px","aria-label":"on/off Dark Mode"},null,8,["modelValue"])]),_:1},8,["title"]),c(k,{"is-link":"",title:r.$t("menus.language"),value:y(f),onClick:i[1]||(i[1]=b=>g.value=!0)},null,8,["title","value"])]),_:1},8,["title"]),c(x,{title:r.$t("menus.advancedSettings"),inset:!0},{default:S(()=>[c(k,{title:r.$t("profile.settings"),icon:"setting-o","is-link":"",to:"/settings"},{icon:S(()=>[...i[5]||(i[5]=[ue("div",{class:"i-carbon:settings text-gray-400 mr-5 self-center"},null,-1)])]),_:1},8,["title"])]),_:1},8,["title"])]),c(P,{show:y(g),"onUpdate:show":i[4]||(i[4]=b=>ee(g)?g.value=b:null),position:"bottom"},{default:S(()=>[c(w,{modelValue:y(h),"onUpdate:modelValue":i[2]||(i[2]=b=>ee(h)?h.value=b:null),columns:y(ce),onConfirm:v,onCancel:i[3]||(i[3]=b=>g.value=!1)},null,8,["modelValue","columns"])]),_:1},8,["show"])],64)}}});typeof de=="function"&&de(pt);export{pt as default};
