import{as as S,d as y,R as A,S as _,ac as L,M as B,j as v,at as C,c as H,H as g,C as I,A as p,aa as V,au as W,g as u,J as U,av as T,aw as j,W as N,X as F,f as M,E as J,k as o}from"./index-B-i7ovUF.js";const K=Symbol(),O=()=>S(K,null),[X,f,Y]=B("list"),q={error:Boolean,offset:L(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:_("down"),loadingText:String,finishedText:String,immediateCheck:A};var z=y({name:X,props:q,emits:["load","update:error","update:loading"],setup(e,{emit:l,slots:a}){const r=v(e.loading),w=v(),n=v(),s=O(),i=C(w),m=H(()=>e.scroller||i.value),d=()=>{U(()=>{if(r.value||e.finished||e.disabled||e.error||(s==null?void 0:s.value)===!1)return;const{direction:t}=e,h=+e.offset,c=T(m);if(!c.height||j(w))return;let b=!1;const x=T(n);t==="up"?b=c.top-x.top<=h:b=x.bottom-c.bottom<=h,b&&(r.value=!0,l("update:loading",!0),l("load"))})},k=()=>{if(e.finished){const t=a.finished?a.finished():e.finishedText;if(t)return u("div",{class:f("finished-text")},[t])}},E=()=>{l("update:error",!1),d()},P=()=>{if(e.error){const t=a.error?a.error():e.errorText;if(t)return u("div",{role:"button",class:f("error-text"),tabindex:0,onClick:E},[t])}},R=()=>{if(r.value&&!e.finished&&!e.disabled)return u("div",{class:f("loading")},[a.loading?a.loading():u(N,{class:f("loading-icon")},{default:()=>[e.loadingText||Y("loading")]})])};return g(()=>[e.loading,e.finished,e.error],d),s&&g(s,t=>{t&&d()}),I(()=>{r.value=e.loading}),p(()=>{e.immediateCheck&&d()}),V({check:d}),W("scroll",d,{target:m,passive:!0}),()=>{var t;const h=(t=a.default)==null?void 0:t.call(a),c=u("div",{ref:n,class:f("placeholder")},null);return u("div",{ref:w,role:"feed",class:f(),"aria-busy":r.value},[e.direction==="down"?h:c,R(),k(),P(),e.direction==="up"?h:c])}}});const G=F(z);function Q(){const e=M(),l=v(!1);function a(){window.history.state.back?history.back():e.replace("/").catch(n=>o.error(n))}p(async()=>{l.value=window.flutter_inappwebview&&window.flutter_inappwebview.callHandler,window.addEventListener("flutterInAppWebViewPlatformReady",r,{passive:!0})}),J(()=>{window.removeEventListener("flutterInAppWebViewPlatformReady",r)});function r(){o.info("flutterInAppWebViewPlatformReady"),l.value=!0}g(l,(n,s)=>{n?window.flutter_inappwebview.callHandler("loaded",!0).then(i=>{o.info("result",i)}).catch(i=>o.error(i)):o.warn("Unsupported browser container.")});function w(n,...s){o.info("dispatchEvent",n,s),l.value?window.flutter_inappwebview.callHandler(n,...s).then(i=>{o.info("result",i)}).catch(i=>o.error(i)):(o.warn("[dispatchEvent]: Unsupported browser container."),n==="close"&&a())}return{flutterInAppWebViewPlatformReady:r,dispatchEvent:w}}export{G as L,Q as u};
