import{l as R,a as z,F as I,_ as U}from"./logo-dark-Dd4_9P0_.js";import{d as G,u as H,f as Q,ay as T,j as c,az as k,H as j,aA as x,c as A,a as L,o as M,h as m,g as a,e as o,m as W,w as l,ak as J,an as K,ao as v,t as y,y as O,v as X,aQ as p,aB as Y,k as Z,_ as ee}from"./index-DT6kcZXb.js";import{C as oe}from"./index-CNmSawNI.js";import"./index-BIT1tiK8.js";import{F as te}from"./index-ahQQxeLs.js";import{b as V}from"./route-block-B_A1xBdJ.js";const ne={id:"sms-login-wrapper",class:"layout-bg m-x-a p-[16px] text-center flex-1 w-7xl"},se={class:"mb-32 mt-20"},ae={class:"rounded-3xl overflow-hidden"},le={class:"sms-code-wrapper mt-16 rounded-3xl overflow-hidden"},re={class:"mt-16"},$=G({__name:"index",setup(ie){const{t:n}=H(),r=Q(),w=T(),g=c(!1),i=c(!1),f=c(!1),b=c(k.value);j(()=>k.value,e=>{b.value=e});const s=x({phone:"",code:""}),S=A(()=>i.value?n("login.gettingCode"):n("login.getCode"));function B(e){return e?/^1[3-9]\d{9}$/.test(e)?null:n("login.pleaseEnterCorrectPhone"):n("login.pleaseEnterPhone")}const _=x({phone:[{validator:B}],code:[{required:!0,message:n("login.pleaseEnterCode")}]});async function D(e){try{g.value=!0;const t=await w.smsLogin({authCode:e.code,mobile:e.phone,channel_id:10001});if(g.value=!1,t){const{redirect:h,...d}=r.currentRoute.value.query;await r.push({path:h||Y,query:{...d}})}}catch(t){Z.error(t)}}async function E(){if(!s.phone){p({type:"warning",message:n("login.pleaseEnterPhone")});return}if(!/^1[3-9]\d{9}$/.test(s.phone)){p({type:"warning",message:n("login.pleaseEnterCorrectPhone")});return}i.value=!0;const e=await w.getCode({type:1,mobile:s.phone});i.value=!1,e?(f.value=!0,p({type:"success",message:"".concat(n("login.sendCodeSuccess"))})):p({type:"danger",message:"".concat(n("login.sendCodeFailed"))})}function F(){const e=r.currentRoute.value.query;r.push({name:"login",query:e})}return(e,t)=>{const h=W,d=te,P=oe,C=K,q=I,N=U;return M(),L("div",ne,[m("div",se,[a(h,{src:o(b)?o(R):o(z),round:"",class:"rounded h-120 w-120",alt:"brand logo"},null,8,["src"])]),a(q,{model:o(s),rules:o(_),"validate-trigger":"onSubmit",onSubmit:D},{default:l(()=>[m("div",ae,[a(d,{modelValue:o(s).phone,"onUpdate:modelValue":t[0]||(t[0]=u=>o(s).phone=u),rules:o(_).phone,name:"phone",type:"tel",placeholder:e.$t("login.phone")},null,8,["modelValue","rules","placeholder"])]),m("div",le,[a(d,{modelValue:o(s).code,"onUpdate:modelValue":t[2]||(t[2]=u=>o(s).code=u),modelModifiers:{trim:!0},rules:o(_).code,name:"code",placeholder:e.$t("login.code")},J({_:2},[o(f)?{name:"button",fn:l(()=>[a(P,{time:6e4,format:"sss",onFinish:t[1]||(t[1]=u=>f.value=!1)})]),key:"0"}:{name:"button",fn:l(()=>[a(C,{size:"small",type:"primary",disabled:o(i),plain:"",onClick:E},{default:l(()=>[v(y(o(S)),1)]),_:1},8,["disabled"])]),key:"1"}]),1032,["modelValue","rules","placeholder"])]),m("div",re,[a(C,{loading:o(g),type:"primary","native-type":"submit",round:"",block:""},{default:l(()=>[v(y(e.$t("menus.sms-login")),1)]),_:1},8,["loading"])])]),_:1},8,["model","rules"]),a(N,{block:"",style:O({"margin-top":o(X)(18)}),onClick:F},{default:l(()=>[v(y(e.$t("login.login-with-password")),1)]),_:1},8,["style"])])}}});typeof V=="function"&&V($);const fe=ee($,[["__scopeId","data-v-6b0694b4"]]);export{fe as default};
